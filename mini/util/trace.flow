import mini/exp/ast;

export {
	CompileStage ::= StageParse, StageCompileTime, StageTypeInference, StageLower;
		StageParse();
		StageCompileTime();
		StageTypeInference();
		// Lower to BExp and optimize
		StageLower();

	// Are we debugging this id? Can be a program id, or a file.
	isDebuggingId(ast : MiniAst, stage : CompileStage, id : string) -> bool;

	isDebuggingIds(ast : MiniAst, stage : CompileStage, ids : Set<string>) -> bool;

}

isDebuggingId(ast : MiniAst, stage : CompileStage, id : string) -> bool {
	containsSet(ast.options.debugIds, id) || containsSet(ast.options.debugIds, "1");
}


isDebuggingIds(ast : MiniAst, stage : CompileStage, ids : Set<string>) -> bool {
	!isEmptySet(intersectSets(ast.options.debugIds, ids)) || containsSet(ast.options.debugIds, "1");
}
