import mini/exp/exp;

export {
	getMiniPos(e : MiniExp) -> int;

	setMiniPos(e : MiniExp, pos : int) -> MiniExp;
}

getMiniPos(e : MiniExp) -> int {
	switch (e) {
		MiniDouble(value, pos): pos;
		MiniString(value, pos): pos;
		MiniInt(value, pos, tyvar): pos;
		MiniVar(name, pos, tyvar): pos;
		MiniLet(name, value, body, pos, tyvar): pos;
		MiniLambda(args, body, pos, tyvar): -1;
		MiniCall(fn, args, pos, tyvar): -1;
	}
}

setMiniPos(e : MiniExp, pos : int) -> MiniExp {
	switch (e) {
		MiniDouble(v, __): MiniDouble(v, pos);
		MiniString(v, __): MiniString(v, pos);
		MiniInt(value, __, tyvar): MiniInt(value, pos, tyvar);
		MiniVar(name, __, tyvar): MiniVar(name, pos, tyvar);
		MiniLet(name, value, body, __, tyvar): MiniLet(name, value, body, pos, tyvar);
		MiniLambda(args, body, __, tyvar): MiniLambda(args, body, pos, tyvar);
		MiniCall(fn, args, __, tyvar): MiniCall(fn, args, pos, tyvar);
	}
}
