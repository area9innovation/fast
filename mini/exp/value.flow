import mini/exp/exp;
import ds/array;

export {
	getMiniInt(m : MiniExp) -> int;
	getMiniString(m : MiniExp) -> string;
	getMiniArray(m : MiniExp) -> [MiniExp];
}

getMiniInt(m : MiniExp) -> int {
	switch (m) {
		MiniInt(i): i;
		default: 0;
	}
}

getMiniString(m : MiniExp) -> string {
	switch (m) {
		MiniString(s): s;
		default: "";
	}
}

getMiniArray(m : MiniExp) -> [MiniExp] {
	switch (m) {
		MiniCall(fn, args): {
			switch (fn) {
				MiniVar(id): {
					if (id == "nil") []
					else if (id == "cons") {
						concat([args[0]], getMiniArray(args[1]))
					} else [];
				}
				default: [];
			}
		}
		default: [];
	}
}
