import mini/types/type;
import text/blueprint;

export {
	mtype2string(t : MiniType) -> string;
}

mtype2string(t : MiniType) -> string {
	switch (t) {
		MiniTypeInt(bits): "i" + i2s(bits);
		MiniTypeFunction(args, returnType): "(" + superglue(args, mtype2string, ", ") + ") -> " + mtype2string(returnType);
		MiniTypeCall(id, typars): id + if (typars != []) "<" + superglue(typars, mtype2string, ", ") + ">" else "";
		MiniTypeVar(id): "Î±" + i2s(id);
		MiniTypePar(id): id;
		MiniTypeRecord(fields): {
			"{" + superglue(fields, \field -> field.name + ":" + mtype2string(field.type), ", ") + "}";
		}
	}
}
