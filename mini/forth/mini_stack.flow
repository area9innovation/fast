import mini/commands/mini_db;

export {
	pushMiniValue(db : MiniDb, val : MiniExp) -> MiniDb;
	popMiniValue(db : MiniDb) -> Pair<MiniExp, MiniDb>;
}

pushMiniValue(db : MiniDb, val : MiniExp) -> MiniDb {
	MiniDb(db with stack = Cons(val, db.stack));
}

popMiniValue(db : MiniDb) -> Pair<MiniExp, MiniDb> {
	switch (db.stack) {
		EmptyList(): Pair(MiniInt(-1), db)
		Cons(h, t): {
			Pair(h, MiniDb(db with stack = t))
		}
	}
}
