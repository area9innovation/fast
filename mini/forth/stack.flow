import mini/commands/db;

export {
	pushMiniValue(db : MiniDb, val : MiniExp) -> MiniDb;
	popMiniValue(db : MiniDb) -> Pair<MiniExp, MiniDb>;
}

pushMiniValue(db : MiniDb, val : MiniExp) -> MiniDb {
	MiniDb(db with forth = MiniForth(db.forth with stack = Cons(val, db.forth.stack)));
}

popMiniValue(db : MiniDb) -> Pair<MiniExp, MiniDb> {
	switch (db.forth.stack) {
		EmptyList(): Pair(MiniInt(-1), db)
		Cons(h, t): {
			Pair(h, MiniDb(db with forth = MiniForth(db.forth with stack = t)))
		}
	}
}
