import mini/commands/compiler;


main() {
	db0 = MiniDb(
		["."], 
		makeTree(), 
		MiniAst(makeTree(), makeTree(), makeTree(), makeTree(), makeTree()),
		MiniForth(makeList()), 
		println
	);

	db = pushMiniCommand(db0, MiniFilename("mini/tests/test.mini"));

	fdb = miniCompile(db);
	iterList(fdb.forth.stack, println);

	println("Final dependencies:");
	traverseInOrder(fdb.program.dependencies, \k, v -> {
		println(k + " depends on " + strGlue(set2array(v), ", "));
	});

	quit(0);
}
