import plow/types/type;

export {
	splitTType(t : TType) -> Pair<TType, [TType]>;
}

splitTType(t : TType) -> Pair<TType, [TType]> {
	switch (t) {
		TTypeName(id, typars): {
			Pair(TTypeName(id, []), typars);
		}
		TTypeEClass(id): Pair(t, []);
		TTypeFunction(args, returnType): {
			Pair(
				// Make sure we keep the arity
				TTypeFunction(map(args, \__ -> TTypeName("", [])), TTypeName("", [])), 
				arrayPush(args, returnType)
			);
		}
		TTypeOverload(typar, overloads): {
			Pair(
				TTypeOverload(typar, makeSet()),
				set2array(overloads)
			)
		}
		TTypeSupertype(unique, subtypes): {
			Pair(
				TTypeSupertype(unique, makeSet()),
				set2array(subtypes)
			)
		}
	}
}
