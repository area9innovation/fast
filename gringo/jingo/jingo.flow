import gringo/gringo_parse;
import gringo/jingo/jingo_grammar;
import gringo/jingo/jingo_ast_actions;
import net/url_parameter;

main() {
	program = getUrlParameterDef("code", "let sq = dup * ; 1 sq");

	// Parse the Jingo program
	env = GringoEnv(program, makeTree(), 0, jingoAstAction, JingoStack(makeList()), false, false);
	genv = gringoParse(env, jingoGrammar());

	if (genv.fail) {
		println("Parsing failed");
	}
	remaining = strRight(env.input, genv.i);
	if (remaining != "") {
		println("Did not parse: " + remaining);
	}

	res = list2array(genv.output.stack);
	println(res);

	quit(0);
}
