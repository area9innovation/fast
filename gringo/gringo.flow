import gringo/gringo_pretty;
import gringo/gringo_grammar;
import gringo/gringo_parse;

main() {
	grammar = gringoGrammar();

	grammar2 = 
		gseq([
			GRule("exp", 
				gchoices([
					gseq([
						GVar("exp", 1),
						GString("+"),
						GVar("exp", 2),
						GUnquote(GString("+")),
					]),
					gseq([
						GVar("exp", 3),
						GString("*"),
						GVar("exp", 4),
						GUnquote(GString("*")),
					]),
					GUnquote(GPlus(GRange(48, 57))),
				]),
			),
			GVar("exp", 0)
		]);

	// TODO: Send in the grammar for gringo itself
	env = GringoEnv(
		"\"abc\"", makeTree(), makeTree(), 0, "", false, false
	);

	genv = gringoParse(env, grammar);

	if (false) {
		println(gterm2string(grammar));
	}

	println("");

	if (genv.fail) {
		println("Parsing failed");
	}
	remaining = strRight(env.input, genv.i);
	if (remaining != "") {
		println("Did not parse: " + remaining);
	}
	println("Output: " + genv.output);
	quit(0);
}
