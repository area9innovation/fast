import gringo/gringo_pretty;
import gringo/gringo_grammar;
import gringo/gringo_parse;

main() {
	grammar2 = gringoGrammar();

	grammar = 
		gseq([
			GBind("term", 
				gchoices([
					// id "=" term(0) ";"	// Binding
					gseq([
						GVar("id", 0),
						GString("="),
						GVar("term", 1),
						GString(";")
					]),
					// term(1) "|" term(2)	// Choice
					gseq([
						GVar("term", 1),
						GString("|"),
						GVar("term", 2),
					]),
					gseq([
						GVar("id", 0),
						GUnquote(GVar("id", 0)),
					])
				]),
			),
			GBind("id", GRange(97, 122)),
			GVar("term", 0)
		]);

	env = GringoEnv(
		"t", makeTree(), makeSet(), 0, "", false,
	);

	genv = gringoParse(env, 0, grammar);

	println("");

	if (genv.fail) {
		println("Parsing failed");
	}
	remaining = strRight(env.input, genv.i);
	if (remaining != "") {
		println("Did not parse: " + remaining);
	}
	println("Output: " + genv.output);
	quit(0);
}
